---
title: '9.4.5 الگو Drop'
slug: go-concurrency-pattern-drop
weight: 177005
---


## 9.4.5.1 توضیحات

الگو Drop یک الگو مهم برای انجام خدمات سنگین می باشد. خدماتی که مواقعی باعث می شود حجم درخواست هایش بیش از ظرفیت موجود باشد و این درخواست ها بواسطه این الگو می تواند Drop شود. به عنوان مثال سرویس های DNS باید از این الگو استفاده کنند.

## 9.4.5.2 دیاگرام

## 9.4.5.3 نمونه کد

```go
package main

import (
	"fmt"
)

func main() {
	in := make(chan int, 5)
	out := make(chan int, 5)

	go func() {
		for {
			select {
			case in <- 1:
			default:
				fmt.Println("Dropping data")
			}
		}
	}()

	go func() {
		for {
			select {
			case data := <-in:
				select {
				case out <- data:
				default:
					fmt.Println("Dropping data")
				}
			}
		}
	}()

	for i := 0; i < 10; i++ {
		fmt.Println(<-out)
	}
}
```

```shell
$ go run main.go
Dropping data
Dropping data
Dropping data
Dropping data
1
Dropping data

Dropping data
Dropping data
1
1
1
1
1
1
Dropping data
Dropping data
Dropping data
Dropping data
Dropping data
Dropping data
1
1
1
```

در کد فوق ما ۲ تا کانال داریم به نام in/out که بافر شده هستند حال کانال in داده را دریافت می کند و پس از آن داده را به کانال out میفرستد. در اینجا اگر حجم داده ای که دریافت شده بیشتر از اندازه کانال in باشد آن بخش زیاد Drop می شود و همچنین کانال out هم همان شرایط را دارد و سعی می کند داده را به اندازه ظرفیت معین شده مدیریت و پردازش کند.

## 9.4.5.4 کاربردها

- Rate limiting: هنگامی که با حجم بالای داده های ورودی سروکار دارید، ممکن است لازم باشد برخی از داده ها را حذف کنید تا حجم پردازش ثابتی حفظ شود.
- Logging: هنگام ثبت داده‌ها، ممکن است لازم باشد که ورودی‌های گزارش را حذف کنید اگر سیستم قادر به هماهنگی با سرعت تولید آنها نباشد.
- Queue: هنگام برخورد با صفی که توسط یک کانال پشتیبانی می شود، ممکن است به جای مسدود کردن فرستنده، لازم باشد داده های دریافتی را در صورت پر بودن صف حذف کنید.
- کنترل ترافیک: هنگام مواجهه با حجم بالای ترافیک ورودی، ممکن است لازم باشد مقداری از ترافیک ورودی را حذف کنید تا حجم پردازش ثابتی حفظ شود.
- سیستم های بلادرنگ (Real-time system): در سیستم‌های بلادرنگ که داده‌ها باید در یک بازه زمانی خاص پردازش شوند، ممکن است لازم باشد که برخی از داده‌های دریافتی حذف شوند، اگر سیستم قادر به هماهنگی با سرعت تولید داده‌ها نباشد.